#include <bits/stdc++.h>
using namespace std;
#define KHEIRA ios::sync_with_stdio(false);
#define WAH cin.tie(nullptr);
int main() {
   KHEIRA WAH
   int t ; cin >> t ; 
   while(t--){
    int n ; cin >> n ;
    vector<int> a(n) ; for(int i = 0 ; i < n ; ++i)cin >> a[i] ; 
    int m ; cin >> m ;
    vector<int> l(n) , r(n) , wah(n) ; 
    wah[0] = 1 ; 
    wah[n-1] = n-2 ; 
    for(int i = 1 ; i < n -1 ; ++i){
      int le = a[i] - a[i-1] ; 
      int ri = a[i+1] - a[i] ; 
      if(le <= ri) wah[i] = i -1 ; 
      else{
        wah[i] = i  +1 ; 
      }
    }
    l[0] = 0 ; r[n-1] = 0 ; 
    for(int i = 1 ; i < n ; ++i){
      if(wah[i-1] == i ){
        l[i] = l[i-1] + 1 ; 
      }else{
        l[i] = l[i-1] +( a[i] - a[i-1] ) ;
      }
    }
    for(int i = n - 2 ; i >= 0  ; --i){
      if(wah[i+1] == i){
        r[i] = r[i+1] + 1;
      }else{
        r[i] = r[i+1] + (a[i+1] - a[i]) ; 
      }
    }

    while(m--){
      int x , y ; cin >> x >> y ; 
      --x ; --y ; 
        if(x<y){
          cout << l[y] - l[x] << endl ; 
        }else{
          cout << r[y] - r[x] << endl ; 
        }
    }

    }
 
    return 0 ; 
   }
//  ░▒▓██████▓▒░   ░▒▓██████▓▒░  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓████████▓▒░ ░▒▓█▓▒░ ░▒▓███████▓▒░   ░▒▓██████▓▒░  
// ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░        ░▒▓█▓▒░ ░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ 
// ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░      ░▒▓██▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ 
// ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░    ░▒▓██▓▒░    ░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓████████▓▒░ 
// ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓██▓▒░      ░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ 
// ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░        ░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ 
//  ░▒▓██████▓▒░   ░▒▓██████▓▒░   ░▒▓██████▓▒░  ░▒▓████████▓▒░ ░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░░▒▓█▓▒░ 
//                                                                                                   
